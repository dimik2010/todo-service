!function(t){var e={};function o(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},o.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=12)}([function(t,e){t.exports={ADDED:"todoAdd",REMOVED:"todoRemove",CHANGED:"todoChanged",UPDATE_VIEW_ADD_NEW:"addToView",UPDATE_VIEW_REMOVE:"removeFromView",UDATE_VIEW_SELECT_ALL:"updateAllSelect",SELECT_ALL:"selectAll",UPDATE_VIEW_STATUS_CHANGED:"updateStatus",DELETE_COMPLETED:"deleteCompleted",FILTER_CHANGED:"filterChanged"}},function(t,e){function o(){this.eventListeners={}}var n=new o;o.prototype.on=function(t,e,o){return t in n.eventListeners?n.eventListeners[t].push({handler:e,context:o}):(n.eventListeners[t]=[],n.eventListeners[t].push({handler:e,context:o})),n},o.prototype.off=function(t,e,o){return n.eventListeners[t]=evenManager.eventListeners[t].filter(function(t){return t.handler!==e&&t.context!==o}),n},o.prototype.trigger=function(t,e){if(void 0!==n.eventListeners[t]){let o=n.eventListeners[t].slice();for(let t=0;t<o.length;t++)o[t].handler.call(o[t].context,e)}return n},t.exports=o},function(t,e){var o=document.createElement("div");var n={todoItem:t=>{let e=function(t){let e=document.getElementById(t);o.innerHTML=e.innerHTML;let n=o.children[0];return o.removeChild(n),n}("template"),n=e.querySelector(".todos-item_done-mark"),i=e.querySelector(".todos-item_delete"),s=e.querySelector(".todos-item_text");return t.text&&(s.innerText=t.text),t.isReady&&(n.checked=!0),{root:e,text:s,doneMark:n,remove:i}}};t.exports=n},function(t,e){function o(){this.mainPath="/items",this.contentType="Content-Type",this.headerType="application/json",this.errorMessage="Error. Try again"}o.prototype.addItem=function(t,e){let o={_text:t.getText(),_isDone:t.isDone()},n=new XMLHttpRequest;n.open("POST",this.mainPath+"/add",!0),n.setRequestHeader(this.contentType,this.headerType),n.send(JSON.stringify(o)),n.onload=function(){if(200===n.status){let t=JSON.parse(n.response);e(t)}else alert(this.errorMessage)}},o.prototype.deleteItem=function(t){let e=new XMLHttpRequest;e.open("DELETE",this.mainPath+"/"+t),e.send()},o.prototype.getUserItems=function(t){let e=new XMLHttpRequest;e.open("GET",this.mainPath+"/list",!0),e.send(),e.onload=function(){if(200===e.status){let o=JSON.parse(e.response);console.log(o),t(o)}else alert(this.errorMessage)}},o.prototype.changeState=function(t){let e={_isDone:t.isDone()},o=new XMLHttpRequest;o.open("PATCH",this.mainPath+"/"+t.getId()+"/changestate"),o.setRequestHeader(this.contentType,this.headerType),o.send(JSON.stringify(e)),o.onload=function(){200!==o.status&&alert(this.errorMessage)}},o.prototype.changeText=function(t){let e={text:t.getText()},o=new XMLHttpRequest;o.open("PATCH",this.mainPath+"/"+t.getId()+"/setcontent"),o.setRequestHeader(this.contentType,this.headerType),o.send(JSON.stringify(e)),o.onload=function(){200!==o.status&&alert(this.errorMessage)}},o.prototype.changeAllToDone=function(){let t=new XMLHttpRequest;t.open("PATCH",this.mainPath+"/changeall"),t.send(),t.onload=function(){200!==t.status&&alert(this.errorMessage)}},requests=new o,t.exports=requests},function(t,e){t.exports={ALL:0,COMPLETED:2,UNDONE:1}},function(t,e,o){const n=o(1);o(0);function i(t){this._id=t._id||0,this._isDone=t._isDone||!1,this._text=t._text}i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.getId=function(){return this._id},i.prototype.setId=function(t){this._id=t},i.prototype.isDone=function(){return this._isDone},i.prototype.setText=function(t){this._text=t},i.prototype.setDone=function(t){this._isDone=!!t},i.prototype.changeDone=function(){return this._isDone=!this._isDone,this._isDone},i.prototype.getText=function(){return this._text},i.prototype.setEventSubscribers=function(){},t.exports=i},function(t,e,o){const n=o(0),i=o(1),s=o(4);function r(t){this._filters=t.children,this._currentFilter=s.ALL,this._filters[s.ALL].addEventListener("click",this._checkAndTrigger.bind(this,s.ALL)),this._filters[s.UNDONE].addEventListener("click",this._checkAndTrigger.bind(this,s.UNDONE)),this._filters[s.COMPLETED].addEventListener("click",this._checkAndTrigger.bind(this,s.COMPLETED))}r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.setEventSubscribers=function(){this.on(n.FILTER_CHANGED,this._onFilterChange,this)},r.prototype._onFilterChange=function(t){this._filters[this._currentFilter].classList.remove("__active"),this._filters[t].classList.add("__active"),this._currentFilter=t},r.prototype._checkAndTrigger=function(t){this._currentFilter!==t&&this.trigger(n.FILTER_CHANGED,t)},t.exports=r},function(t,e,o){const n=o(0),i=o(1);function s(t,e){this._listModel=e,this._deleteCompletedButton=t.querySelector(".todos-status-bar_delete-completed"),this._undoneCounterText=t.querySelector(".todos-status-bar_counter"),this._deleteCompletedButton.addEventListener("click",this._onDeleteCompletedClick.bind(this))}s.prototype=Object.create(i.prototype),s.prototype.constructor=s,s.prototype._onDeleteCompletedClick=function(t){this.trigger(n.DELETE_COMPLETED)},s.prototype._onAnyChange=function(){this._undoneCounterText.innerText=this._listModel.getItemsUndone()+" tasks to do"},s.prototype.setEventSubscribers=function(){this.on(n.ADDED,this._onAnyChange,this),this.on(n.CHANGED,this._onAnyChange,this),this.on(n.SELECT_ALL,this._onAnyChange,this),this.on(n.REMOVED,this._onAnyChange,this)},t.exports=s},function(t,e,o){o(2);const n=o(1),i=o(0),s=o(3);function r(t,e){this._root=t.root,this._model=e,this._doneMark=t.doneMark,this._removeButton=t.remove,this._text=t.text,this._doneMark.addEventListener("click",this._onChangeState.bind(this)),this._text.addEventListener("blur",this._onBlurText.bind(this)),this._removeButton.addEventListener("click",this._onRemoveButtonClick.bind(this)),this.render()}r.prototype=Object.create(n.prototype),r.prototype.constructor=r,r.prototype._onBlurText=function(t){console.log("inside blur text"+this._text.innerText),this._model.setText(this._text.innerText),s.changeText(this.getModel())},r.prototype._onChangeState=function(t){this.trigger(i.CHANGED,this._model)},r.prototype.getRoot=function(){return this._root},r.prototype.getModel=function(){return this._model},r.prototype._onRemoveButtonClick=function(t){this.trigger(i.REMOVED,this._model)},r.prototype.hide=function(){this._root.classList.contains("__hidden")||this._root.classList.add("__hidden")},r.prototype.show=function(){this._root.classList.contains("__hidden")&&this._root.classList.remove("__hidden")},r.prototype.render=function(){this._model.isDone()?this._root.classList.add("__done"):this._root.classList.remove("__done")},t.exports=r},function(t,e,o){const n=o(2),i=o(1),s=o(0),r=o(4),h=o(8);function c(t,e){this._todoListModel=t,this._root=e,this._itemViews=[]}c.prototype=Object.create(i.prototype),c.prototype.constructor=c,c.prototype._onAdd=function(t){if(t.constructor===Array)for(let e=0;e<t.length;e++)this._createNewItem(t[e],this._root);else this._createNewItem(t,this._root)},c.prototype._createNewItem=function(t,e){let o={text:t.getText(),isReady:t.isDone()},i=n.todoItem(o),s=new h(i,t);this._itemViews.push(s),e.appendChild(i.root)},c.prototype._onSelectAll=function(){for(let t=0;t<this._root.children.length;t++)this._root.children[t].classList.add("__done")},c.prototype._onItemModelChange=function(t){this._itemViews.find(e=>e._model.getId()===t.getId()).render()},c.prototype._onItemRemove=function(t){let e=this._itemViews.findIndex(e=>e._model.getId()===t.getId());this._root.removeChild(this._itemViews[e].getRoot()),this._itemViews.splice(e,1)},c.prototype._onFilterChange=function(t){switch(t){case r.ALL:for(let t=0;t<this._itemViews.length;t++)this._itemViews[t].show();break;case r.COMPLETED:for(let t=0;t<this._itemViews.length;t++)this._itemViews[t].getModel().isDone()?this._itemViews[t].show():this._itemViews[t].hide();break;case r.UNDONE:for(let t=0;t<this._itemViews.length;t++)this._itemViews[t].getModel().isDone()?this._itemViews[t].hide():this._itemViews[t].show()}},c.prototype.setEventSubscribers=function(){this.on(s.UPDATE_VIEW_ADD_NEW,this._onAdd,this),this.on(s.UDATE_VIEW_SELECT_ALL,this._onSelectAll,this),this.on(s.UPDATE_VIEW_STATUS_CHANGED,this._onItemModelChange,this),this.on(s.UPDATE_VIEW_REMOVE,this._onItemRemove,this),this.on(s.FILTER_CHANGED,this._onFilterChange,this)},t.exports=c},function(t,e,o){const n=o(0),i=o(1);o(5),o(2);function s(t){this._input=t.querySelector(".todos-input_input-text"),this._selectAllButton=t.querySelector(".todos-input_select-all"),this._input.addEventListener("keypress",this),this._selectAllButton.addEventListener("click",this)}s.prototype=Object.create(i.prototype),s.prototype.constructor=s,s.prototype.handleEvent=function(t){switch(t.type){case"click":t.target===this._selectAllButton&&this.trigger(n.SELECT_ALL);break;case"keypress":13===t.keyCode&&(""!==this._input.value&&this.trigger(n.ADDED,{_text:this._input.value.trim()}),this._input.value="")}},t.exports=s},function(t,e,o){const n=o(1),i=o(0),s=o(5),r=o(3);function h(t){this._items=t||[],this._itemsUndone=0}h.prototype=Object.create(n.prototype),h.prototype.constructor=h,h.prototype.setItemsArray=function(t){for(let e=0;e<t.length;e++)this.add.call(this,t[e],!0)},h.prototype.getItems=function(){return this._items},h.prototype.getItemsUndone=function(){return this._itemsUndone},h.prototype.updateItemsUndone=function(){for(let t=0;t<this._items.length;t++)this._items[t].isDone()||this._itemsUndone++},h.prototype.add=function(t,e){let o=new s(t);void 0===e&&r.addItem(o,function(t){o.setId(t._id)}),this._items.push(o),this._itemsUndone++,this.trigger(i.UPDATE_VIEW_ADD_NEW,o)},h.prototype.delete=function(t){let e=this._items.findIndex(e=>e.getId()===t.getId());console.log(t.getId()),r.deleteItem(t.getId()),this.trigger(i.UPDATE_VIEW_REMOVE,this._items[e]),this._items[e].isDone()||this._itemsUndone--,this._items.splice(e,1)},h.prototype._onSelectAll=function(){for(let t=0;t<this._items.length;t++)this.setDone(this._items[t],!0);this._itemsUndone=0,r.changeAllToDone(),this.trigger(i.UDATE_VIEW_SELECT_ALL)},h.prototype.setDone=function(t,e){t.setDone(e)},h.prototype._onItemChange=function(t){let e=this._items.findIndex(e=>e.getId()===t.getId());this._items[e].changeDone()?this._itemsUndone--:this._itemsUndone++,r.changeState(this._items[e]),this.trigger(i.UPDATE_VIEW_STATUS_CHANGED,this._items[e])},h.prototype._onDeleteCompleted=function(){let t=0;for(;t<this._items.length;)this._items[t].isDone()?(this.trigger(i.UPDATE_VIEW_REMOVE,this._items[t]),r.deleteItem(this._items[t].getId()),this._items.splice(t,1)):t++},h.prototype.setEventSubscribers=function(){this.on(i.ADDED,this.add,this),this.on(i.REMOVED,this.delete,this),this.on(i.SELECT_ALL,this._onSelectAll,this),this.on(i.CHANGED,this._onItemChange,this),this.on(i.DELETE_COMPLETED,this._onDeleteCompleted,this)},t.exports=h},function(t,e,o){document.addEventListener("DOMContentLoaded",function(){const t=document.querySelector(".main-wrapper"),e=(new i(t.querySelector(".todos-input")),new n);c.getUserItems(t=>e.setItemsArray(t));const o=new s(e,t.querySelector(".todos-items-list")),d=new r(t.querySelector(".todos-status-bar"),e),_=new h(t.querySelector(".todos-status-bar").querySelector(".todos-status-bar_filters"));e.setEventSubscribers(),o.setEventSubscribers(),d.setEventSubscribers(),_.setEventSubscribers()});const n=o(11),i=o(10),s=o(9),r=o(7),h=o(6),c=o(3)}]);
//# sourceMappingURL=bundle.js.map